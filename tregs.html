
<html>
<head>
	<title>T-REGS</title>
	<meta property="og:title" content="T-REGS" />
	<meta property="og:description" content="T-REGS Project page." />
	<style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');
   </style>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<link rel="stylesheet" type="text/css" media="all" href="style/project-page.css" />
	<!-- SLOWS DOWN THE PAGE POLYFILL -->
	<!-- <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> -->
	<script id="MathJax-script" defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> 
	<script>
	window.MathJax = {
	tex: {
		inlineMath: [['$', '$'], ['\\(', '\\)']],
		displayMath: [['$$', '$$'], ['\\[', '\\]']]
	}
	};
	</script>
</head>



<body  style="--main-color: rgb(142, 202, 230);">	
	<header class="site-header">
		<div class="site-header__inner">
			<!-- <div class="site-brand">Julie Mordacq</div> -->
			<nav class="site-nav">
				<ul>
					<li><a class="custom-link" href="#abstract">Overview</a></li>
					<li><a class="custom-link" href="#method">T-REG</a></li>
					<li><a class="custom-link" href="#tregs">T-REG for SSL</a></li>
					<li><a class="custom-link" href="#bibtex">Bibtex</a></li>
					<li><a class="custom-link" href="#acknowledgements">Acknowledgements</a></li>
				</ul>
			</nav>
		</div>
	</header>
	<div class="title">
		<h1>T-REGS: Minimum Spanning Tree Regularization for Self-Supervised Learning</h1>
		<br>

		<ul class="publication-authors ul" align="center">
			<li><a href="https://jumdc.github.io/">Julie Mordacq<sup>1,2</sup></a></li>
			<li><a href="https://github.com/leomlck">David Loiseaux<sup>1,2</sup></a></li>
			<li><a href="https://vicky.kalogeiton.info/">Vicky Kalogeiton<sup>2</sup></a></li>
			<li><a href="https://geometrica.saclay.inria.fr/team/Steve.Oudot/">Steve Oudot<sup>1,2</sup></a></li>
		</ul>
		<ul class="publication-institutions ul" align="center">	
			<li><sup>1</sup> Inria Saclay</span></li>
			<li><sup>2</sup> Ecole Polytechnique</span></li>
		</ul>
	</div>
	
	<br>
	
	<!-- <h3>MIDL 2024</h3> -->
	
	<div align="center">
		<ul class="publication-links ul">
			<li><div class="box"><a class="box-link" href="https://arxiv.org/abs/2407.03836">
				<img src="assets/arxiv-logomark-small-square.svg" width="20" height="20" style="margin-right: 0.5rem; vertical-align: middle;" alt="arXiv"> Paper</a></div></li>
			<li><div class="box"><a class="box-link" href="https://github.com/jumdc/ADAPT">
				<i class="fa-brands fa-github icon" style="margin-right: 0.5rem;"></i>Code</a></div></li>
		</ul>
		<br>
	
	</div>

	
	
	<div id="abstract" class="abstract">
			<h2>Overview</h2>
			<p>Self-supervised learning (SSL) enables learning representations without labeled data by enforcing invariance to transformations. Effective SSL representations avoid <i>dimensional collapse</i> and enhance <i>uniformity</i>. We introduce T-REGS, a simple and efficient regularization framework based on the Minimum Spanning Tree ($\mathrm{MST}$) length, which mitigates collapse and promotes uniformity. </p>
			<!-- introducing treg -->
			<p>We first introduce, a new regularization: T-REG. The central idea is to maximize the length of the $\mathrm{MST}$ of the samples in the embedding space. It has strong theoretical connections to the line of work on statistical dimension estimation via entropy maximization <a href="http://www-stat.wharton.upenn.edu/~steele/Publications/PDF/Steele88a%20.pdf">(Steele, 1988)</a>.
			More explicitly, given a point cloud $Z$ in Euclidean space, a spanning tree (ST) of $Z$ is an undirected graph $G=(V,E)$ with vertex set  $V=Z$ and edge set $E\subset V\times V$ such that $G$ is connected without cycle. 
			We define the length of $G$ as:
			\begin{equation}
				E(G) := \sum_{(z,z')\in E} \|z-z'\|_2
				\label{eq:alpha_length}
			\end{equation}
			A minimum spanning tree of $Z$, denoted by $\mathrm{MST}(Z)$, is an ST of $Z$ that minimizes length $E$.
			<!-- t is unique under a genericity condition on $Z$.
			Since the length of $\mathrm{MST}(Z)$ scales under rescaling of $Z$, maximizing it alone leads the points to diverge. 
			To prevent trivial scaling, T-REG constrains embeddings to a compact manifold, encouraging full use of the representation dimension and a uniform distribution. -->
			</p>
			<p>We show both theoretically and empirically that T-REG naturally prevents dimensional collapse while enforcing sample uniformity. And, we apply T-REG to SSL either as standalone regularization, combining directly with view-invariance, or as an auxiliary loss to existing methods, yielding the <b>T-REGS</b> frameworkâ€” whose effectiveness is evaluated through experiments on standard JE-SSL benchmarks.</p>
	</div>
	
	<div id="method" class="content">
		<h2>T-REG: Minimum Spanning Tree based Regularization</h2>
		<hr class="separator">
		<br>

		<div>
			<p>
				Our regularization T-REG has two terms, given $Z = \{z_1, ..., z_n\}\subseteq\mathbb{R}^d$, the set of $n$ embeddings of dimension $d$:  
				<ul style="list-style-type: lower-roman; font-style: italic;">
					<li>A length-maximization loss $\mathcal{L}_{\text{E}}$ that decreases with the length of the minimum spanning tree:
					\begin{equation}
						\mathcal{L}_{\text{E}}(Z) = - \frac{1}{n} \,\text{E}(\mathrm{MST}({Z})),
					\end{equation}
					where $\text{E}(\mathrm{MST}({Z}))$ denotes the length of the $\mathrm{MST}$ of $Z$.
					<br> <br>
					</li>
					<li>A soft sphere-constraint $\mathcal{L}_{\text{S}}$ that increases with the distance to a fixed sphere $\mathbb{S}$, given by:
						\begin{equation}
						\mathcal{L}_\text{S}(Z) = \frac{1}{n} \sum_i (\Vert z_i\Vert_2 - 1)^2.
					\end{equation}
					</li>
				</ul>
				
		These two terms combined force the embeddings to lie on $\mathbb{S}$ (or close to it), while spreading them out along $\mathbb{S}$.

		Maximizing the MST length alone would cause the points to diverge to infinity; the sphere constraint prevents this by keeping the embeddings within a fixed region around $\mathbb{S}$.
		The overall T-REG loss combines these two terms:
		\begin{equation}\label{eq:TREG}
			\mathcal{L}_{\text{T-REG}}(Z) = \gamma\, \mathcal{L}_{\text{E}}(Z) + \lambda\,  \mathcal{L}_\text{S}(Z),
		\end{equation}
		where $\gamma$ and $\lambda$ are hyperparameters controlling the trade-off between spreading out the embeddings and maintaining them on the sphere.
			</p>
		
		</div>
		<h2>Theoretical Analysis</h2>
		
		<div >
			<h3 style="text-align: left;">Behavior on small samples</h3>
			
			<p>
				We begin by considering the case where $n\le d+1$. It is particularly relevant since, in SSL, batch sizes are often smaller than or comparable to the ambient dimension. In order to account for the effect of the soft sphere constraint, we assume the points of $X$ lie inside some fixed closed Euclidean $d$-ball ${B}$ of radius $r$ centered at the origin.</p>
			
			<p class="box-math"><b>Theorem 1: </b>Under the above conditions, the maximum of $\text{E}({X})$ over the point sets $X\subset{B}$ of fixed cardinality $n$ is attained when the points of $X$ lie  on the sphere ${S}=\partial{B}$, at the vertices of a regular $(n-1)$-simplex that has ${S}$ as its  smallest circumscribing sphere.</p>
		
		<p>Theorem 1 explains the behavior of T-REG as follows: first, minimizing the term $\mathcal{L}_{\text{E}}$ in expands the point cloud until the sphere constraint term $\mathcal{L}_{\text{S}}$ becomes the dominating term (which happens eventually since $\mathcal{L}_{\text{S}}$ grows quadratically with the scaling factor, versus linearly for $\mathcal{L}_{\text{E}}$); at that stage, the points stop expanding and start spreading themselves out uniformly along the sphere of directions. The amount of expansion before spreading is prescribed by the strength of the sphere constraint term versus the term in the loss, which is driven by the ratio between their respective mixing parameters $\lambda$ and $\gamma$.</p>
		</div>

		<div >
			<h3 style="text-align: left;">Asymptotic behavior on large samples</h3>
			<p>We now consider the case where $n> d+1$, focusing specifically on the asymptotic behavior as $n\to\infty$. We analyze the constant $C$ in Theorem 1 of <a href="http://www-stat.wharton.upenn.edu/~steele/Publications/PDF/Steele88a%20.pdf">(Steele, 1988)</a>, which can be made independent of the density of the sampling $X$. This, in particular, allows us to show that uniform and dimension-maximizing densities are asymptotically optimal for $E(\mathrm{MST}(\cdot))$. We fix a compact Riemannian $d$-manifold, $\mathcal{M}$, equipped with the $d$-dimensional Hausdorff measure $\mu$.</p>
			<p class="box-math"><b>Theorem 2: </b>Let $X_n$ be an iid $n$-sample of a probability measure on $\mathcal{M}$ with density $f_X$ w.r.t. $\mu$. Then, there exists a constant $C'$ independent of $f_X$ and of $\mathcal M$ such that:
				\begin{equation}
				n^{-\frac {d-1}{d}} \cdot \text{E}(X_n) \xrightarrow[n\to \infty]{}{C' \int f_X^{\frac{d-1}{d}}}\mathrm{d} \mu
				\quad
				\textnormal{almost surely.}
			\end{equation}</p>
		</div>

		<h2>Empirical Analysis</h2>
		<br>
		<div style=" text-align: center;">
			<p style="text-align: justify; width: 80%; margin: 0 auto;">
				We generate a set of 256 points in $\mathbb{R}^3$,  initially concentrated around a specific point on the unit sphere, and apply T-REG to optimize the point cloud.
				We observe that T-REG successfully spreads points uniformly on the sphere.
			</p>
			<img src="assets/treg-3d-animation.gif" alt="T-REGS" style="max-width: 800px; text-align: center;">
			<br>
			<p style="text-align: justify; width: 80%; margin: 0 auto;">
				Without the sphere constraint, the points diverge to infinity, as shown below:
			</p>
			<br>
			<img src="assets/le-3d-animation.gif" alt="T-REGS" style="max-width: 800px; text-align: center;">
		</div>
	</div>
	
	<div id="tregs" class="content">
		<h2>T-REGS: T-REG for SSL</h2>
		<hr class="separator">
	</div>

	<div id="bibtex" class="content">
		<h2>Bibtex</h2>
		<hr class="separator">
		<div class="bibtex-container">
		   <button class="copy-btn" onclick="copyBibtex()" title="Copy BibTeX">
			   <i class="fa-solid fa-copy"></i> Copy BibTeX
		   </button>
		   <pre><code class="language-bibtex" id="bibtex-code">coming soon...<br>
		</code></pre>
	   </div>
	</div>
	</div>
	
	<div id="acknowledgements" class="content">
		<h2>Acknowledgements</h2>
		<hr class="separator">
	</div>
	
</body>

</html>